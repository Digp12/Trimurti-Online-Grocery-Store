<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="ISO-8859-1">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        .register-container {
            max-width: 1300px; /* Increased max-width */
            margin: auto;
            padding: 20px;
        }
        .card {
            border-radius: 12px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        }
        .btn-primary {
            background-color: #007bff;
            border: none;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .image-container img{
          max-width:100%;
          height: auto;
        }
    </style>
</head>
<body>
    <section class="register-container mt-5">
        <div class="row g-4 align-items-center">
            <div class="col-md-6 text-center image-container" >
                <img src="img/3793121.jpg" alt="" class="img-fluid rounded">
            </div>
            <div class="col-md-6">
                <div class="card p-4">
                    <div class="card-header text-center bg-white border-0">
                        <h4 class="fw-bold">Register</h4>
                    </div>
                    <div class="card-body">
						<!-- Success message -->
						<div th:if="${session.succMsg}" class="alert alert-success alert-dismissible fade show" role="alert">
						    <span th:text="${session.succMsg}"></span>
						    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>

						<!-- Error message -->
						<div th:if="${session.errorMsg}" class="alert alert-danger alert-dismissible fade show" role="alert">
						    <span th:text="${session.errorMsg}"></span>
						    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
                        <form action="/saveUser" enctype="multipart/form-data" id="userRegister" method="post">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Full Name</label>
                                    <input required class="form-control" name="name" type="text">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Mobile Number</label>
                                    <input required class="form-control" name="mobileNumber" type="number">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input required class="form-control" name="email" type="email">
                            </div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Address</label>
                                    <input required class="form-control" name="address" type="text">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">City</label>
                                    <input required class="form-control" name="city" type="text">
                                </div>
                            </div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">State</label>
                                    <input required class="form-control" name="state" type="text">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Pincode</label>
                                    <input required class="form-control" name="pincode" type="number">
                                </div>
                            </div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Password</label>
                                    <input required class="form-control" name="password" id="password" type="password">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Confirm Password</label>
                                    <input required class="form-control" name="confirmpassword" id="confirmpass" type="password">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Profile Image</label>
                                <input class="form-control" name="img" type="file">
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Register</button>
                        </form>
                    </div>
                    <div class="card-footer text-center bg-white border-0">
                        <p>Already have an account? <a href="signin" class="text-decoration-none">Login</a></p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Add required JavaScript files -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/additional-methods.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/script.js"></script>
    <script>
        $(document).ready(function() {
            console.log("jQuery loaded:", typeof $ !== 'undefined');
            console.log("jQuery Validate loaded:", typeof $.validator !== 'undefined');
            
            // Initialize validation
            $("#userRegister").validate({
                rules: {
                    name: { required: true, lettersonly: true },
                    email: { required: true, space: true, email: true },
                    mobileNumber: { required: true, space: true, numericOnly: true, minlength: 10, maxlength: 12 },
                    password: { required: true, space: true, passwordStrength: true },
                    confirmpassword: { required: true, space: true, equalTo: '#password' },
                    address: { required: true, all: true },
                    city: { required: true, space: true },
                    state: { required: true },
                    pincode: { required: true, space: true, numericOnly: true },
                    img: { required: true, imageType: true }
                },
                messages: {
                    name: { required: 'Name required', lettersonly: 'Invalid name' },
                    email: { required: 'Email required', space: 'No spaces allowed', email: 'Invalid email' },
                    mobileNumber: { required: 'Mobile no required', space: 'No spaces', numericOnly: 'Invalid number', minlength: 'Min 10 digits', maxlength: 'Max 12 digits' },
                    password: { required: 'Password required', space: 'No spaces', passwordStrength: 'Min 8 chars, 1 uppercase, 1 number, 1 special char' },
                    confirmpassword: { required: 'Confirm password', space: 'No spaces', equalTo: 'Passwords do not match' },
                    address: { required: 'Address required', all: 'Invalid address' },
                    city: { required: 'City required', space: 'No spaces' },
                    state: { required: 'State required' },
                    pincode: { required: 'Pincode required', space: 'No spaces', numericOnly: 'Invalid pincode' },
                    img: { required: 'Image required', imageType: 'Only jpg, jpeg, png allowed' }
                },
                errorElement: 'span',
                errorPlacement: function(error, element) {
                    error.addClass('text-danger');
                    error.insertAfter(element);
                }
            });

            // Add custom validation methods
            $.validator.addMethod('lettersonly', function(value, element) {
                return /^[^-\s][a-zA-Z_\s-]+$/.test(value);
            });

            $.validator.addMethod('space', function(value, element) {
                return /^[^-\s]+$/.test(value);
            });

            $.validator.addMethod('all', function(value, element) {
                return /^[^-\s][a-zA-Z0-9_,.\s-]+$/.test(value);
            });

            $.validator.addMethod('numericOnly', function(value, element) {
                return /^[0-9]+$/.test(value);
            });

            $.validator.addMethod('imageType', function(value, element) {
                return this.optional(element) || /\.(jpg|jpeg|png)$/i.test(value);
            });

            $.validator.addMethod('passwordStrength', function(value, element) {
                return /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(value);
            });
        });
    </script>
</body>
</html>